Traceback (most recent call last):
  File "/home/john/anaconda3/lib/python3.7/site-packages/jupyter_cache/executors/utils.py", line 56, in single_nb_execution
    record_timing=False,
  File "/home/john/anaconda3/lib/python3.7/site-packages/nbclient/client.py", line 968, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/home/john/anaconda3/lib/python3.7/site-packages/nbclient/util.py", line 72, in wrapped
    return just_run(coro(*args, **kwargs))
  File "/home/john/anaconda3/lib/python3.7/site-packages/nbclient/util.py", line 51, in just_run
    return loop.run_until_complete(coro)
  File "/home/john/anaconda3/lib/python3.7/asyncio/base_events.py", line 587, in run_until_complete
    return future.result()
  File "/home/john/anaconda3/lib/python3.7/site-packages/nbclient/client.py", line 509, in async_execute
    cell, index, execution_count=self.code_cells_executed + 1
  File "/home/john/anaconda3/lib/python3.7/site-packages/nbclient/client.py", line 747, in async_execute_cell
    self._check_raise_for_error(cell, exec_reply)
  File "/home/john/anaconda3/lib/python3.7/site-packages/nbclient/client.py", line 671, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply['content'])
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
def unit_simplex(angle):
    
    fig = plt.figure(figsize=(8, 6))
    ax = fig.add_subplot(111, projection='3d')

    vtx = [[0, 0, 1],
           [0, 1, 0], 
           [1, 0, 0]]
    
    tri = Poly3DCollection([vtx], color='darkblue', alpha=0.3)
    tri.set_facecolor([0.5, 0.5, 1])
    ax.add_collection3d(tri)

    ax.set(xlim=(0, 1), ylim=(0, 1), zlim=(0, 1), 
           xticks=(1,), yticks=(1,), zticks=(1,))

    ax.set_xticklabels(['$(1, 0, 0)$'], fontsize=12)
    ax.set_yticklabels(['$(0, 1, 0)$'], fontsize=12)
    ax.set_zticklabels(['$(0, 0, 1)$'], fontsize=12)

    ax.xaxis.majorTicks[0].set_pad(15)
    ax.yaxis.majorTicks[0].set_pad(15)
    ax.zaxis.majorTicks[0].set_pad(35)

    ax.view_init(30, angle)

    # Move axis to origin
    ax.xaxis._axinfo['juggled'] = (0, 0, 0)
    ax.yaxis._axinfo['juggled'] = (1, 1, 1)
    ax.zaxis._axinfo['juggled'] = (2, 2, 0)
    
    ax.grid(False)
    
    return ax

Q = np.array(Q)
Ïˆ_00 = np.array((0.01, 0.01, 0.99))
Ïˆ_01 = np.array((0.01, 0.99, 0.01))
Ïˆ_02 = np.array((0.99, 0.01, 0.01))

ax = unit_simplex(angle=50)    

def flow_plot(Ïˆ, h=0.001, n=400, angle=50):
    colors = cm.jet_r(np.linspace(0.0, 1, n))

    x_vals, y_vals, z_vals = [], [], []
    for t in range(n):
        x_vals.append(Ïˆ[0])
        y_vals.append(Ïˆ[1])
        z_vals.append(Ïˆ[2])
        Ïˆ = Ïˆ @ expm(h * Q)

    ax.scatter(x_vals, y_vals, z_vals, c=colors, s=20, alpha=0.2, depthshade=False)

flow_plot(Ïˆ_00)
flow_plot(Ïˆ_01)
flow_plot(Ïˆ_02)

# Add stationary distribution
#P_1 = expm(Q)

#mc = qe.MarkovChain(P_1)
#Ïˆ_star = mc.stationary_distributions
#ax.scatter(0.2, 0.2, 0.6, c='k', s=20, alpha=0.2, depthshade=False)

plt.show()
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mNameError[0m                                 Traceback (most recent call last)
[0;32m<ipython-input-3-125acd954e11>[0m in [0;36m<module>[0;34m[0m
[1;32m     53[0m     [0max[0m[0;34m.[0m[0mscatter[0m[0;34m([0m[0mx_vals[0m[0;34m,[0m [0my_vals[0m[0;34m,[0m [0mz_vals[0m[0;34m,[0m [0mc[0m[0;34m=[0m[0mcolors[0m[0;34m,[0m [0ms[0m[0;34m=[0m[0;36m20[0m[0;34m,[0m [0malpha[0m[0;34m=[0m[0;36m0.2[0m[0;34m,[0m [0mdepthshade[0m[0;34m=[0m[0;32mFalse[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m     54[0m [0;34m[0m[0m
[0;32m---> 55[0;31m [0mflow_plot[0m[0;34m([0m[0mÏˆ_00[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m     56[0m [0mflow_plot[0m[0;34m([0m[0mÏˆ_01[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m     57[0m [0mflow_plot[0m[0;34m([0m[0mÏˆ_02[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m

[0;32m<ipython-input-3-125acd954e11>[0m in [0;36mflow_plot[0;34m(Ïˆ, h, n, angle)[0m
[1;32m     42[0m [0;34m[0m[0m
[1;32m     43[0m [0;32mdef[0m [0mflow_plot[0m[0;34m([0m[0mÏˆ[0m[0;34m,[0m [0mh[0m[0;34m=[0m[0;36m0.001[0m[0;34m,[0m [0mn[0m[0;34m=[0m[0;36m400[0m[0;34m,[0m [0mangle[0m[0;34m=[0m[0;36m50[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0;32m---> 44[0;31m     [0mcolors[0m [0;34m=[0m [0mcm[0m[0;34m.[0m[0mjet_r[0m[0;34m([0m[0mnp[0m[0;34m.[0m[0mlinspace[0m[0;34m([0m[0;36m0.0[0m[0;34m,[0m [0;36m1[0m[0;34m,[0m [0mn[0m[0;34m)[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m     45[0m [0;34m[0m[0m
[1;32m     46[0m     [0mx_vals[0m[0;34m,[0m [0my_vals[0m[0;34m,[0m [0mz_vals[0m [0;34m=[0m [0;34m[[0m[0;34m][0m[0;34m,[0m [0;34m[[0m[0;34m][0m[0;34m,[0m [0;34m[[0m[0;34m][0m[0;34m[0m[0;34m[0m[0m

[0;31mNameError[0m: name 'cm' is not defined
NameError: name 'cm' is not defined

